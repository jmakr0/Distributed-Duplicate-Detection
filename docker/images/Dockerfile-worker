FROM rdse/base

ARG JAR_NAME
ARG MASTER_HOST

ENV ROLE="worker"
ENV MASTER_HOST=$MASTER_HOST
ENV JAR_NAME=$JAR_NAME
ENV WORKERS=4
ENV MASTER_PORT=7877
ENV WORKER_PORT=7879

EXPOSE $WORKER_PORT

CMD java -jar $JAR_NAME $ROLE \
        -w $WORKERS \
        -p $WORKER_PORT \
        -mh $MASTER_HOST \
        -mp $MASTER_PORT > $LOG_DIR/${LOG_SUB_DIR}${ROLE}_${HOSTNAME}.log && \ 
        touch $LOG_DIR/${LOG_SUB_DIR}${ROLE}_${HOSTNAME}.done.log
